{"cells":[{"cell_type":"code","execution_count":198,"metadata":{"executionInfo":{"elapsed":403,"status":"ok","timestamp":1705939753676,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"0qyuBNTCLB3p"},"outputs":[],"source":["import numpy as np\n","import matplotlib.pyplot as plt\n","import pandas as pd"]},{"cell_type":"code","execution_count":199,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3257,"status":"ok","timestamp":1705939757580,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"PGRgKKydrFU8","outputId":"4ea4a06e-8924-4c38-a090-de5b68d5ca17"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive/; to attempt to forcibly remount, call drive.mount(\"/content/drive/\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive/')"]},{"cell_type":"code","execution_count":200,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":700,"status":"ok","timestamp":1705939758274,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"XHOBBnptrH-k","outputId":"98eaf87c-2b5c-46cf-be84-f33318853191"},"outputs":[{"output_type":"stream","name":"stdout","text":["[[0 0 0 ... 0 0 0]\n"," [0 0 0 ... 0 0 0]\n"," [0 0 0 ... 0 0 0]\n"," ...\n"," [0 0 0 ... 0 0 0]\n"," [0 0 0 ... 0 0 0]\n"," [0 0 0 ... 0 0 0]]\n"]}],"source":["df = pd.read_csv('/content/drive/MyDrive/woc/Classification_train.zip')\n","df=np.array(df)\n","x=df[:15000,1:785]\n","y=df[:15000,0]\n","x_test=df[15000:,1:785]\n","y_test=df[15000:,0]\n","print(x)"]},{"cell_type":"code","execution_count":201,"metadata":{"executionInfo":{"elapsed":732,"status":"ok","timestamp":1705939759003,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"EBAko6T7rQsN"},"outputs":[],"source":["class KNN():\n","  def __init__(self,k,x,y):\n","    self.k=k\n","  def normalize(self,x):\n","    mean=np.mean(x,axis=1)\n","    sigma=np.std(x,axis=1)\n","    for i in range(x.shape[0]):\n","      if sigma[i]==0:\n","        x[i]=0\n","      else:\n","        x[i]=(x[i]-mean[i])/(sigma[i])\n","    return x\n","  def distance(self,x,x_):\n","    x=self.normalize(x)\n","    d=(x-x_)**2\n","    d=np.sqrt(np.sum(d,axis=1)).reshape(-1,1)\n","    return d\n","  def nearest_points(self,x,y,x_):\n","    d=self.distance(x,x_)\n","    d=np.argsort(d,axis=0)[:self.k]\n","    k_nearest_points=[y[i] for i in d]\n","    return k_nearest_points\n","  def mode(self,x,y,x_):\n","    a=self.nearest_points(x,y,x_)\n","    max=0\n","    mode=None\n","    for num in a:\n","      count=sum([1 for n in a if np.array_equal(n,num)])\n","      if count>max:\n","        max=count\n","        mode=num\n","    return mode\n","  def test(self,x,y,x_test):\n","    y_=np.zeros(x_test.shape[0])\n","    for i in range(x_test.shape[0]):\n","      x_=x_test[i]\n","      y_[i]=self.mode(x,y,x_)\n","    return y_"]},{"cell_type":"code","execution_count":202,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fim79kJXrS9u","executionInfo":{"status":"ok","timestamp":1705942557688,"user_tz":-330,"elapsed":2798688,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"}},"outputId":"9cfa094d-d43c-43e4-b85f-5af3f2431c17"},"outputs":[{"output_type":"stream","name":"stdout","text":["[1. 9. 2. ... 9. 3. 9.]\n","0.9728666666666667\n"]}],"source":["knn=KNN(6,x,y)\n","y_=knn.test(x,y,x_test)\n","print(y_)\n","acc=np.sum(y_==y_test)/len(y_)\n","print(acc)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"q2kUxaYS5qHB","executionInfo":{"status":"aborted","timestamp":1705939745902,"user_tz":-330,"elapsed":2,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"}}},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"o80ireSv6X9h","executionInfo":{"status":"aborted","timestamp":1705939745902,"user_tz":-330,"elapsed":2,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"}}},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KEjEV64FrTOJ","executionInfo":{"status":"aborted","timestamp":1705939745902,"user_tz":-330,"elapsed":2,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"}}},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SUXwchaFt3hO","executionInfo":{"status":"aborted","timestamp":1705939745903,"user_tz":-330,"elapsed":3,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"}}},"outputs":[],"source":[]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyOCINHDUVhz3zkJsMQwck1E"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}