{"cells":[{"cell_type":"code","execution_count":161,"metadata":{"executionInfo":{"elapsed":710,"status":"ok","timestamp":1705939785759,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"IobzPYJ_3WnK"},"outputs":[],"source":["import numpy as np\n","import matplotlib.pyplot as plt\n","import pandas as pd"]},{"cell_type":"code","execution_count":162,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6126,"status":"ok","timestamp":1705939792799,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"JqvNAryeTyWB","outputId":"43706b8f-83a6-47ee-c741-a28dfbd2d3f3"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive/; to attempt to forcibly remount, call drive.mount(\"/content/drive/\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive/')"]},{"cell_type":"code","execution_count":163,"metadata":{"executionInfo":{"elapsed":7917,"status":"ok","timestamp":1705939800713,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"LODDvOZPTys_"},"outputs":[],"source":["df = pd.read_csv('/content/drive/MyDrive/woc/Classification_train.zip')\n","df=np.array(df)\n","data=np.zeros((30000,10))\n","df=np.hstack((df,data))\n","for j in range(10):\n","  for i in range(30000):\n","    if df[i,0]==j:\n","      df[i,785+j]=1\n","    else:\n","      df[i,785+j]=0"]},{"cell_type":"code","execution_count":164,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1705939800714,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"w1i7K3xloftJ"},"outputs":[],"source":["class LogisticRegression():\n","  def __init__(self,alpha,num_iterations,lambda_,num_features):\n","    self.w=np.zeros((num_features,1))\n","    self.b=0\n","    self.alpha=alpha\n","    self.num_iterations=num_iterations\n","    self.lambda_=lambda_\n","  def normalize(self,x):\n","    mean=np.mean(x,axis=1)\n","    sigma=np.std(x,axis=1)\n","    for i in range(x.shape[0]):\n","      if sigma[i]==0:\n","        x[i]=0\n","      else:\n","        x[i]=(x[i]-mean[i])/(sigma[i])\n","    return x\n","  def sigmoid(self,x):\n","    a=np.dot(x,self.w)+self.b\n","    epsilon=10**-8\n","    f=1/(1+np.exp(-a+epsilon))\n","    return f\n","  def cost_function(self,x,y):\n","    m=len(x)\n","    r=(self.lambda_/2)*np.sum(self.w**2)\n","    epsilon=10**-8\n","    l=-((y)*(np.log(self.sigmoid(x)+epsilon)))-((1-y)*(np.log(1-self.sigmoid(x)+epsilon)))\n","    j=(np.sum(l)+r)\n","    j=j/m\n","    return j\n","  def gradient_descent(self,x,y):\n","    m,n=x.shape\n","    j_history=np.zeros(self.num_iterations,)\n","    for i in range(self.num_iterations):\n","      f=self.sigmoid(x)\n","      dj_dw=(np.dot(x.T,f)+self.lambda_*self.w)\n","      dj_db=np.sum(f-y)\n","      dj_dw=dj_dw/m\n","      dj_db=dj_db/m\n","      self.w=self.w-self.alpha*dj_dw\n","      self.b=self.b-self.alpha*dj_db\n","      j_history[i]=self.cost_function(x,y)\n","    return self.w,self.b,j_history\n","  def train_lr(self,x,y):\n","    x_=self.normalize(x)\n","    w,b,j_history=self.gradient_descent(x_,y)\n","    return j_history,w,b"]},{"cell_type":"code","execution_count":165,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1705939800714,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"},"user_tz":-330},"id":"Xoy78DTu6A1g","outputId":"96b966f5-e8af-4a37-f532-6cc935fd7a21"},"outputs":[{"output_type":"stream","name":"stdout","text":["[[0. 0. 0. ... 0. 0. 0.]\n"," [0. 0. 0. ... 0. 0. 0.]\n"," [0. 0. 0. ... 0. 0. 0.]\n"," ...\n"," [0. 0. 0. ... 0. 0. 0.]\n"," [0. 0. 0. ... 0. 0. 0.]\n"," [0. 0. 0. ... 0. 0. 0.]]\n","[0. 0. 0. ... 0. 0. 0.]\n"]}],"source":["x=df[:15000,1:785]\n","y=df[15000:,785:795]\n","x_test=df[15000:,1:785]\n","y_test=df[:15000,785:795]\n","print(x)\n","print(y[:,0])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PHEtmkYQ_Isa","outputId":"9328aa5b-456f-415f-bcd1-5cdf96ebe6e0"},"outputs":[{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["<ipython-input-164-43206f90f117>:20: RuntimeWarning: overflow encountered in exp\n","  f=1/(1+np.exp(-a+epsilon))\n"]}],"source":["w_=np.zeros((x.shape[1],10))\n","b_=np.zeros(10)\n","mlr=LogisticRegression(0.9,200,1,x.shape[1])\n","for i in range(10):\n","  j_history,w,b=mlr.train_lr(x,y[:,i])\n","  w_[:,i]=w.reshape(-1,)\n","  b_[i]=b"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JsvC0hqZXN-F"},"outputs":[],"source":["w_"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SNHbsf1WJFwd"},"outputs":[],"source":["b_"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CLBMuE2VCcMu"},"outputs":[],"source":["\n","class multinomiallogisticregression():\n","  def __init__(self,w_,b_):\n","    self.w_=w_\n","    self.b_=b_\n","  def find_z(self):\n","    z=np.zeros(10)\n","    for i in range(10):\n","      z[i]=np.dot(x_test,w[:,i])+b[i]\n","    return z\n","  def softmax(self):\n","    z=self.find_z()\n","    z_=np.exp(z)\n","    p=np.zeros(10)\n","    for i in range(10):\n","      p[i]=z_[i]/np.sum(z_)\n","    p_=np.max(p)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z8SOiph0J67r"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WZgerfFvOonC","executionInfo":{"status":"aborted","timestamp":1705937515221,"user_tz":-330,"elapsed":2,"user":{"displayName":"Siriprolu Teja","userId":"02891279464309838914"}}},"outputs":[],"source":[]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyMopzX9oMJOg45CRxS08l9N"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}